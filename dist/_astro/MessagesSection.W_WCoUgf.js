import{j as e}from"./jsx-runtime.brvLbZ6j.js";import{r as m}from"./index.9-aKW1zO.js";import{u}from"./index.jt7Q199V.js";import{G as g,B as p}from"./iconBase.YqCPaJlw.js";import{c as d,s as f,a as x}from"./index.aZD16Ifr.js";import{$ as h,s as b}from"./chat.NOEI-ekU.js";import{$ as j}from"./friends.BnE_cv0P.js";import"./index.a4cdf180.iEdQifKq.js";import"./axios.tkkU2NWh.js";import"./auth.Ilt-Bd4Y.js";import"./index.rS7vpNfE.js";function w(a){return g({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"},child:[]}]})(a)}const v=({id:a,name:s,rows:r=1,boxSize:o="md",disabled:t=!1,classes:c,children:i,...n})=>{const l=d(c,t?f.muted:"bg-[--background] hover:opacity-80","border-[--border]","border-2","rounded-[--radius]","m-0","px-[10px]","py-[5px]");return e.jsxs("div",{className:"flex flex-col flex-nowrap grow",children:[e.jsx("label",{className:"text-[--secondary-foreground]",htmlFor:a,children:i}),e.jsx("textarea",{className:l,id:a,name:s,rows:r,disabled:t,"data-size":o,...n})]})},y=({submitNewMessage:a})=>{const[s,r]=m.useState(""),o=m.useRef(null),t=n=>{n.preventDefault(),!(!s||s.length<=0)&&a(s).then(()=>r(""))},c=n=>{n.key==="Enter"&&!n.shiftKey&&(n.preventDefault(),o.current&&o.current.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0})))},i=n=>{const l=n.target;r(l.value),l.rows=l.value!==""?Math.floor(l.scrollHeight/34):1};return e.jsxs("form",{autoComplete:"off",ref:o,onSubmit:t,className:"flex justify-between gap-2",children:[e.jsx(v,{id:"message-text",name:"message",boxSize:"lg",placeholder:"Message",value:s,onChange:i,onKeyDown:c}),e.jsx(p,{type:"submit",size:"lg",classes:"text-5xl",disabled:s.length<=0,children:e.jsx(w,{})})]})},N=({content:a,date:s,isMine:r})=>{const t=d(r?"self-end":"self-start",r?f.accent:x.primary,"p-2","max-w-[400px]","rounded-[--radius]");return e.jsxs("section",{className:`flex ${t}`,children:[e.jsx("span",{className:"self-start",children:a}),e.jsx("small",{className:"ps-2 self-end text-[--muted-foreground]",children:String(s)})]})},D=()=>{const a=u(h),s=u(j),r=m.useRef(null);m.useEffect(()=>{r.current&&(r.current.scrollTop=r.current.scrollHeight)},[a.messages&&a.messages?.length]);const o=async t=>{const c={targetUserId:s.currentFriendChat.id,content:t};return await b(c)};return e.jsx("main",{className:"p-4 overflow-y-auto bg-[--accent]",children:e.jsxs("div",{className:"flex flex-col gap-4 h-full",children:[e.jsx("div",{ref:r,className:"flex flex-col gap-1 overflow-y-auto grow",children:a.messages?.map(t=>e.jsx(N,{isMine:t.senderId!==s.currentFriendChat?.id,content:t.content,date:t.date},t.id))}),s.currentFriendChat&&e.jsx(y,{submitNewMessage:o})]})})};export{D as default};
