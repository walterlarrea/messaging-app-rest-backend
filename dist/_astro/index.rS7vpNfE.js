let l=[],a=(s,o)=>{let n=[],t={get(){return t.lc||t.listen(()=>{})(),t.value},l:o||0,lc:0,listen(i,u){return t.lc=n.push(i,u||t.l)/2,()=>{let e=n.indexOf(i);~e&&(n.splice(e,2),--t.lc||t.off())}},notify(i){let u=!l.length;for(let e=0;e<n.length;e+=2)l.push(n[e],n[e+1],t.value,i);if(u){for(let e=0;e<l.length;e+=4){let f;for(let r=e+1;!f&&(r+=4)<l.length;)l[r]<l[e+1]&&(f=l.push(l[e],l[e+1],l[e+2],l[e+3]));f||l[e](l[e+2],l[e+3])}l.length=0}},off(){},set(i){t.value!==i&&(t.value=i,t.notify())},subscribe(i,u){let e=t.listen(i,u);return i(t.value),e},value:s};return t};export{a};
